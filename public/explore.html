<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tripease Explorer — Explore</title>
  <style>
    /* Reused visual language from your main page */
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif}
    body{
      background:url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1920&q=80') no-repeat center/cover;
      color:#fff;overflow-x:hidden;padding-bottom:60px
    }
    .container{width:92%;max-width:1200px;margin:26px auto}
    header{display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,.08);padding:12px 20px;border-radius:12px}
    header nav a{color:#cde; text-decoration:none;margin-right:12px;font-weight:600}
    header .brand{font-weight:800;color:#00e6e6}

    /* Explore hero */
    .hero{margin:22px 0;padding:28px;border-radius:14px;background:linear-gradient(135deg, rgba(255,255,255,0.06), rgba(0,0,0,0.18));backdrop-filter:blur(6px)}
    .hero h1{font-size:28px;margin-bottom:8px}
    .hero p{color:#dfe}

    /* Controls */
    .controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    .controls input,.controls select{padding:10px;border-radius:10px;border:none;min-width:180px}
    .controls button{padding:10px 14px;border-radius:10px;border:none;background:#00b3b3;color:#fff;cursor:pointer}

    /* Suggestion grid/list */
    .explore-wrap{display:flex;gap:18px;margin-top:18px}
    .left{flex:1}
    .right{width:320px}

    .filters{background:rgba(255,255,255,.95);color:#000;padding:12px;border-radius:12px}
    .filters h3{margin-bottom:8px}
    .filters label{display:block;margin:8px 0;font-size:14px}
    .filters input[type='range']{width:100%}

    .results{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px}
    .card{background:#fff;color:#000;border-radius:12px;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.12);transition:transform .18s}
    .card:hover{transform:translateY(-6px)}
    .card img{width:100%;height:140px;object-fit:cover}
    .card .meta{padding:12px}
    .card h4{margin-bottom:6px}
    .card p{font-size:13px;color:#333;margin-bottom:8px}
    .card .tags{display:flex;gap:8px;flex-wrap:wrap}
    .tag{font-size:12px;background:#e6fbfb;color:#006d6d;padding:6px 8px;border-radius:999px;border:1px solid #bff6f6}
    .card .cta{display:flex;justify-content:space-between;align-items:center;padding:0 12px 14px}
    .btn{background:#00b3b3;color:#fff;border:none;padding:8px 10px;border-radius:8px;cursor:pointer}

    /* List view */
    .list-view .results{display:block}
    .list-item{display:flex;gap:12px;align-items:center;background:#fff;color:#000;padding:10px;border-radius:10px;margin-bottom:12px}
    .list-item img{width:110px;height:78px;object-fit:cover;border-radius:8px}
    .list-item .info{flex:1}

    /* right column */
    .sticky{position:sticky;top:20px}
    .mini-card{background:rgba(255,255,255,.95);color:#000;padding:12px;border-radius:10px;margin-bottom:12px}

    footer{margin-top:28px;text-align:center;color:#dfe}

    /* responsive tweaks */
    @media (max-width:900px){
      .explore-wrap{flex-direction:column}
      .right{width:100%}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">Tripease Explorer</div>
      <nav>
        <a href="index.html">Home</a>
        <a href="explore.html" style="color:#00b3b3">Explore</a>
        <a href="contact.html">Contact</a>
      </nav>
    </header>

    <section class="hero">
      <h1>Find the perfect trip in seconds</h1>
      <p>Personalized suggestions powered by categories, interests and quick filters. Use the controls to refine results.</p>

      <div class="controls">
        <input type="text" id="search" placeholder="Search destinations, activities..." />
        <select id="mood">
          <option value="">All moods</option>
          <option value="adventure">Adventure</option>
          <option value="relax">Relax</option>
          <option value="culture">Culture</option>
          <option value="romantic">Romantic</option>
        </select>
        <select id="duration">
          <option value="">Any duration</option>
          <option value="1-2">1-2 days</option>
          <option value="3-4">3-4 days</option>
          <option value="5+">5+ days</option>
        </select>
        <button id="btn-apply">Apply</button>
        <button id="btn-reset" style="background:#666">Reset</button>
      </div>
    </section>

    <div class="explore-wrap">
      <div class="left">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
          <h2 style="color:#dfe">Recommended Trips</h2>
          <div>
            <button id="gridBtn" class="btn">Grid</button>
            <button id="listBtn" class="btn" style="background:#666">List</button>
          </div>
        </div>

        <div id="resultsContainer" class="results" style="margin-top:14px"></div>

        <div id="noResults" style="display:none;margin-top:18px;color:#ffd">No trips found. Try changing filters.</div>
      </div>

      <aside class="right">
        <div class="sticky">
          <div class="mini-card">
            <h3>Popular Categories</h3>
            <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:8px">
              <button class="tag" data-cat="Beach">Beach</button>
              <button class="tag" data-cat="Mount">Mount</button>
              <button class="tag" data-cat="City">City</button>
              <button class="tag" data-cat="Desert">Desert</button>
              <button class="tag" data-cat="Adventure">Adventure</button>
              <button class="tag" data-cat="Cultural">Cultural</button>
            </div>
          </div>

          <div class="mini-card">
            <h3>Quick Tips</h3>
            <ul style="margin-top:8px;color:#333">
              <li>Use the mood filter for targeted suggestions.</li>
              <li>Click "Save" to add to Favorites (local storage).</li>
              <li>Connect booking providers to enable live prices.</li>
            </ul>
          </div>

          <div class="mini-card">
            <h3>Integrations</h3>
            <p style="color:#333">Hook any search/booking API by implementing <code>fetchTripsFromAPI()</code> in the script. By default the page uses demo data.</p>
          </div>
        </div>
      </aside>
    </div>

    <footer>© 2025 Tripease Explorer</footer>
  </div>

  <script>
    // ---------- Demo trip data (replace or augment with API results) ----------
    const demoTrips = [
      { id: 't1', title: 'Rajasthan Desert Camp', img: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1200&q=60', tags: ['Desert','Cultural'], mood: 'relax', duration: '3-4', price: 8500, desc: 'Sleep under the stars and enjoy folk music.' },
      { id: 't2', title: 'Goa Beach Escape', img: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1200&q=60', tags: ['Beach','Relax'], mood: 'relax', duration: '3-4', price: 6000, desc: 'Sun, sand and seafood—perfect for a weekend.' },
      { id: 't3', title: 'Himachal Trekking Trail', img: 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1200&q=60', tags: ['Mount','Adventure'], mood: 'adventure', duration: '5+', price: 12000, desc: 'Multi-day trek with stunning mountain views.' },
      { id: 't4', title: 'Kolkata Cultural Walk', img: 'https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?auto=format&fit=crop&w=1200&q=60', tags: ['City','Cultural'], mood: 'culture', duration: '1-2', price: 2200, desc: 'Heritage walk, museums and local cuisine.' },
      { id: 't5', title: 'Andaman Island Cruise', img: 'https://images.unsplash.com/photos/a-boat-with-people-on-it-is-in-the-water-BH9HTBLJPXU?auto=format&fit=crop&w=1200&q=60', tags: ['Beach','Adventure'], mood: 'adventure', duration: '5+', price: 25000, desc: 'Snorkeling, diving and island hopping.' }
    ];

    // ---------- State ----------
    let viewMode = 'grid';
    const results = document.getElementById('resultsContainer');
    const noResults = document.getElementById('noResults');

    // ---------- Renderers ----------
    function renderGrid(trips){
      results.innerHTML = '';
      trips.forEach(t => {
        const el = document.createElement('div'); el.className = 'card';
        el.innerHTML = `
          <img src="${t.img}" alt="${t.title}" />
          <div class="meta">
            <h4>${t.title}</h4>
            <p>${t.desc}</p>
            <div class="tags">${t.tags.map(x => `<span class="tag">${x}</span>`).join('')}</div>
          </div>
          <div class="cta">
            <div style="font-weight:700;padding-left:12px">₹${t.price}</div>
            <div>
              <button class="btn" onclick="openBooking('${t.id}')">Book</button>
              <button class="btn" style="background:#fff;color:#000;margin-left:8px" onclick="saveFav('${t.id}', this)">Save</button>
            </div>
          </div>
        `;
        results.appendChild(el);
      })
    }

    function renderList(trips){
      results.innerHTML = '';
      trips.forEach(t => {
        const li = document.createElement('div'); li.className = 'list-item';
        li.innerHTML = `
          <img src="${t.img}" alt="${t.title}" />
          <div class="info">
            <h4>${t.title} <span style="font-size:12px;color:#666;margin-left:6px">(${t.duration} days)</span></h4>
            <p style="margin:6px 0;color:#333">${t.desc}</p>
            <div class="tags">${t.tags.map(x => `<span class="tag">${x}</span>`).join('')}</div>
          </div>
          <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
            <div style="font-weight:700">₹${t.price}</div>
            <div>
              <button class="btn" onclick="openBooking('${t.id}')">Book</button>
            </div>
          </div>
        `;
        results.appendChild(li);
      })
    }

    // ---------- Filtering & Search ----------
    function applyFilters(){
      const q = document.getElementById('search').value.trim().toLowerCase();
      const mood = document.getElementById('mood').value;
      const duration = document.getElementById('duration').value;

      let filtered = demoTrips.filter(t => {
        const inQ = !q || (t.title+ ' ' + t.desc + ' ' + t.tags.join(' ')).toLowerCase().includes(q);
        const inMood = !mood || t.mood === mood;
        const inDuration = !duration || t.duration === duration;
        return inQ && inMood && inDuration;
      });

      if(filtered.length === 0){ noResults.style.display='block'; } else { noResults.style.display='none'; }
      if(viewMode === 'grid') renderGrid(filtered); else renderList(filtered);
    }

    // ---------- Actions ----------
    document.getElementById('btn-apply').addEventListener('click', applyFilters);
    document.getElementById('btn-reset').addEventListener('click', () => { document.getElementById('search').value=''; document.getElementById('mood').value=''; document.getElementById('duration').value=''; applyFilters(); });
    document.getElementById('gridBtn').addEventListener('click', ()=>{ viewMode='grid'; renderGrid(demoTrips); });
    document.getElementById('listBtn').addEventListener('click', ()=>{ viewMode='list'; renderList(demoTrips); });

    // category quick tags
    document.querySelectorAll('.tag[data-cat]').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const cat = btn.dataset.cat.toLowerCase();
        document.getElementById('search').value = cat; applyFilters();
      })
    });

    // favorites (localStorage)
    function saveFav(id, el){
      const favs = JSON.parse(localStorage.getItem('tripease.favs')||'[]');
      if(favs.includes(id)) {
        // remove
        const idx = favs.indexOf(id); favs.splice(idx,1); el.innerText='Save';
      } else { favs.push(id); el.innerText='Saved'; }
      localStorage.setItem('tripease.favs', JSON.stringify(favs));
    }

    // booking stub (opens booking panel in parent site if present)
    function openBooking(id){
      const trip = demoTrips.find(t=>t.id===id);
      if(!trip) return alert('Trip not found');
      // For now we open a simple modal to simulate booking flow
      const modal = document.createElement('div');
      modal.style.position='fixed';modal.style.inset=0;modal.style.background='rgba(0,0,0,.6)';modal.style.display='flex';modal.style.alignItems='center';modal.style.justifyContent='center';
      modal.innerHTML = `
        <div style='background:#fff;color:#000;padding:18px;border-radius:12px;max-width:560px;width:92%'>
          <h3>${trip.title}</h3>
          <p style='color:#333'>${trip.desc}</p>
          <p style='font-weight:700'>Price: ₹${trip.price}</p>
          <div style='display:flex;gap:8px;justify-content:flex-end;margin-top:12px'>
            <button id='m-close' style='padding:8px 10px;border-radius:8px;background:#666;color:#fff;border:none'>Close</button>
            <button id='m-confirm' style='padding:8px 10px;border-radius:8px;background:#00b3b3;color:#fff;border:none'>Proceed to Book</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      modal.querySelector('#m-close').addEventListener('click',()=>modal.remove());
      modal.querySelector('#m-confirm').addEventListener('click',async ()=>{
        // Save booking intent to localStorage and also attempt to submit to server-side booking endpoint
        localStorage.setItem('tripease.booking', JSON.stringify(trip));
        try {
          const res = await fetch('/api/book', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ tripId: trip.id, name: 'Guest', email: '', travelers: 1 })
          });
          const json = await res.json();
          if(res.ok) alert('Booking created: ' + (json.bookingId || json._id || 'ok'));
          else alert('Booking failed: ' + (json.message || JSON.stringify(json)));
        } catch(err){
          console.warn('booking error', err);
          alert('Booking saved locally. Implement server booking flow to persist.');
        }
        modal.remove();
      });
    }

    // ---------- Hook point: replace this with your API fetch ----------
    async function fetchTripsFromAPI(){
      // If your server exposes /api/trips, uncomment below and comment demo return
      try {
        const res = await fetch('/api/trips');
        if(res.ok){
          const json = await res.json();
          if(Array.isArray(json)) return json;
          if(json.trips) return json.trips;
        }
      } catch(e){
        // ignore and fallback to demo
      }
      // For now return demo data
      return demoTrips;
    }

    // ---------- Init ----------
    (async function init(){
      const trips = await fetchTripsFromAPI();
      // if you replace fetchTripsFromAPI to call a real API, ensure objects match demoTrip shape
      if(viewMode === 'grid') renderGrid(trips); else renderList(trips);
    })();

  </script>
</body>
</html>
